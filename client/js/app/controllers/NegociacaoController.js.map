{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_ordemAtual","_listaNegociacoes","Bind","ListNegociacoes","NegociacoesView","_mensagem","Mensagem","MensagemView","service","NegociacaoService","_showNegociacoes","event","preventDefault","negociacao","_criaNegociacao","cadastraNegociacao","then","texto","mensagem","_adicionaNegociacao","_cleanForm","catch","error","importa","negociacoes","forEach","Negociacao","DateUtils","textToDate","value","lista","console","log","setInterval","importarNegociacao","apaga","_esvaziaLista","focus","coluna","inverteOrdem","ordena","a","b"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["class NegociacaoController {\n\n    constructor() {\n        let $ = document.querySelector.bind(document);\n        this._inputData = $('#data');\n        this._inputQuantidade = $('#quantidade');\n        this._inputValor = $('#valor');\n        this._ordemAtual = '';\n\n        this._listaNegociacoes = new Bind(new ListNegociacoes(),\n                                 new NegociacoesView($('#negociacoes-view')),\n                                '_adicionaNegociacao', '_esvaziaLista', 'ordena','inverteOrdem');\n\n        this._mensagem = new Bind(new Mensagem(),\n                                  new MensagemView($('#mensagem-view')),\n                                 'texto');\n        this.service = new NegociacaoService();\n        this._showNegociacoes();\n    }\n\n    adiciona(event) {\n        event.preventDefault();\n\n        let negociacao = this._criaNegociacao();\n        this.service.cadastraNegociacao(negociacao).then(mensagem => {\n            this._mensagem.texto = mensagem;\n            this._listaNegociacoes._adicionaNegociacao(negociacao);\n            this._cleanForm();\n        }).catch(error => this._mensagem.texto = error);\n    }\n\n    importarNegociacao() {\n        //then -> passando lista de negociações que não foram importadas.\n        this.service\n            .importa(this._listaNegociacoes.negociacoes)\n            .then(negociacoes => negociacoes.forEach(negociacao => {\n                this._listaNegociacoes._adicionaNegociacao(negociacao);\n                this._mensagem.texto = 'Negociacoes importadas com sucesso!';\n            })).catch(error => this._mensagem.texto = error);\n    }\n    _criaNegociacao() {\n        return new Negociacao(DateUtils.textToDate(this._inputData.value),\n        this._inputQuantidade.value, this._inputValor.value);\n    }\n\n    _showNegociacoes() {\n        this.service\n            .lista()\n            .then(negociacoes =>\n                negociacoes.forEach(negociacao =>\n                this._listaNegociacoes._adicionaNegociacao(negociacao))\n            ).catch(error => console.log(error));\n\n        setInterval(() => {\n            this.importarNegociacao();\n        },3000)\n    }\n\n    apaga() {\n        this.service.apaga()\n               .then(mensagem => {\n                   this._mensagem.texto = mensagem;\n                   this._listaNegociacoes._esvaziaLista();\n               }).catch(error => this._mensagem.texto = error);\n    }\n\n    _cleanForm() {\n        this._inputData.value = '';\n        this._inputQuantidade.value = '';\n        this._inputValor.value = '';\n        this._inputData.focus();\n    }\n\n    ordena(coluna) {\n        if(this._ordemAtual === coluna) {\n            this._listaNegociacoes.inverteOrdem();\n        }\n        else {\n            this._listaNegociacoes.ordena((a,b) => a[coluna] - b[coluna]);\n         }\n         this._ordemAtual = coluna;\n    }\n}\n"]}